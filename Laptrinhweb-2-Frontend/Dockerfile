# ================== STAGE 1: Build React app ==================
FROM node:18 AS build

# ƒê·∫∑t th∆∞ m·ª•c l√†m vi·ªác trong container
WORKDIR /app

# Copy file khai b√°o dependencies
COPY package*.json ./

# C√†i ƒë·∫∑t dependencies (node_modules)
RUN npm install

# Copy to√†n b·ªô source code v√†o container
COPY . .

# Build ·ª©ng d·ª•ng React th√†nh static files (output n·∫±m trong /build)
RUN npm run build


# ================== STAGE 2: Serve React app ==================
# üëâ C√≥ 2 l·ª±a ch·ªçn: DEV (npm start) ho·∫∑c PROD (Nginx)

# ---------------- DEV mode (npm start) ----------------
# Ch·ªâ d√πng khi ph√°t tri·ªÉn (hot reload)
EXPOSE 4000
CMD ["npm", "run", "dev"]

# ---------------- PROD mode (Nginx) ----------------
# Uncomment n·∫øu b·∫°n mu·ªën build production
# FROM nginx:1.25.1
# COPY --from=build /app/build /usr/share/nginx/html
# EXPOSE 80
# CMD ["nginx", "-g", "daemon off;"]
